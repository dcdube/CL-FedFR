cd /home/master/FedFR-main/split_dataset


Generate FL dataset
python3 split_FL.py --data_dir '/home/master/FedFR-main/faces_emore' --output_dir '/home/master/FedFR-main/ms1m_split' --num_ID 4000 --num_client 40


Generate Pretrained dataset
python3 split_pretrain.py --data_dir '/home/master/FedFR-main/faces_emore' --output_dir '/home/master/FedFR-main/ms1m_split' --num_ID 6000 --num_client 1


Training our FedFR
sh run.sh


Personalized Evaluation: 1:1 Evaluation
python3 local_all.py --backbone 'multi' --task '1:1' --ckpt_path '/home/master/FedFR-main/ckpt/FedFR' --data_dir '/home/master/FedFR-main/ms1m_split/local_veri_4000' --gallery '/home/master/FedFR-main/ms1m_split/local_gallery_4000' --epoch -1 --num_client 40 --gpu 0 1 2 3


Personalized Evaluation: 1:n Evaluation
python3 local_all.py --backbone 'multi' --task '1:n' --ckpt_path '/home/master/FedFR-main/ckpt/FedFR' --data_dir '/home/master/FedFR-main/ms1m_split/local_veri_4000' --gallery '/home/master/FedFR-main/ms1m_split/local_gallery_4000' --epoch -1 --num_client 40 --gpu 0 1 2 3


Generic Evaluation
python3 ijbc_conti.py --root_path '/home/master/FedFR-main/IJBC' --ckpt_dir '/home/master/FedFR-main/ckpt/FedFR' --epoch 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 --gpu 0 1 2 3 --job 'both'
python3 ijbc_conti.py --root_path '/home/master/FedFR-main/IJBC' --ckpt_dir '/home/master/FedFR-main/ckpt/FedFR' --epoch 18 19 --gpu 0 1 2 3 --job 'both'

Concatenate IJB dataset
cat IJB.tar.gz.00 IJB.tar.gz.01 IJB.tar.gz.02 IJB.tar.gz.03 IJB.tar.gz.04 IJB.tar.gz.05 IJB.tar.gz.06 IJB.tar.gz.07 IJB.tar.gz.08 IJB.tar.gz.09 IJB.tar.gz.10 IJB.tar.gz.11 IJB.tar.gz.12 IJB.tar.gz.13 IJB.tar.gz.14 > IJB.tar.gz


## im2rec.py
cd /home/master/FedFR-main/ms1m_split/split_train_i4000c0040/client_0000
python /home/master/FedFR-main/im2rec.py --list train --no-shuffle --recursive /home/master/FedFR-main/ms1m_split/split_pretrain_6000/client_0000/pretrain_images_6000
python /home/master/FedFR-main/im2rec.py train.lst --no-shuffle /home/master/FedFR-main/ms1m_split/split_pretrain_6000/client_0000/pretrain_images_6000


for i in {0000..0039}; do
    client_dir="/home/master/FedFR-main/ms1m_split/split_train_i4000c0040/client_$i"
    cd "$client_dir"
    
    python /home/master/FedFR-main/im2rec.py --list train --no-shuffle --recursive /home/master/FedFR-main/ms1m_split/split_train_i4000c0040/client_$i/easy
    
    python /home/master/FedFR-main/im2rec.py train.lst --no-shuffle /home/master/FedFR-main/ms1m_split/split_train_i4000c0040/client_$i/easy
done


